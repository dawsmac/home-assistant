- id: '600'
  alias: Doorbell Annunciator front door
  initial_state: true
  # someone walked into Zone A on Frigate
  trigger:
    - platform: mqtt
      topic: frigate/porch_path_a/person
      payload: '1'
  action:
    - wait_for_trigger:
        - platform: mqtt
          topic: frigate/porch_path_b/person
          payload: '1'
      timeout:
        minutes: "00:01:00"
      continue_on_timeout: false
    # will only fire if someone walk into Zopne B and we are home 
    - choose:
      - conditions:
        - condition: state
          entity_id: group.persons
          state: "home"       
        sequence:
          service: notify.alexa_media
          data:
            message: someone is at the front door
            target: media_player.kitchen_echo
            data:
              type: announce
    # will only fire if someone walk into Zopne B and we are out
    - choose:
      - conditions:
        - condition: state
          entity_id: group.persons
          state: "not_home"       
        sequence:
          - service: script.sonos_say
            data:
              sonos_entity: media_player.kitchen
              volume: 0.7
              message: 'someone is at the front door'
              delay: '00:00:05'
  
- id: '601'
  alias: Doorbell Annunciator1
  initial_state: true
  # someone pushing the button on my Ring triggers automation
  trigger:
    - platform: state
      entity_id: binary_sensor.driveway_movement
      to: 'on'
  # will only fire if the sonos speakers by the pool are playing
  condition:
    - condition: state
      entity_id: media_player.kitchen
      state: 'playing'
  # calls the sonos_say script to announce that someone is at the door
  action:
    - service: script.sonos_say
      data:
        sonos_entity: media_player.kitchen
        volume: 0.7
        message: 'someone is coming up the garden'
        delay: '00:00:05'