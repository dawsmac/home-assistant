- id: '1300'
  alias: morning mode
  trigger:
    - platform: state
      id: 'morningalarm'
      entity_id: binary_sensor.morning_alarm
      to: 'on'
    - platform: template
      id: 'morningaway'
      value_template: "{{ is_state('sun.sun', 'above_horizon') }}"
  action:
    - choose:
        - conditions:
            - condition: trigger
              id: 'morningalarm'
            - condition: time
              after: '05:00'
              before: '09:00'
            - condition: state
              entity_id: input_select.house_mode
              state: 'Night'
            - condition: state
              entity_id: group.persons
              state: 'home'
          sequence:
            - service: input_select.select_option
              data:
                entity_id: input_select.house_mode
                option: 'Awake'
        - conditions:
            - condition: trigger
              id: 'morningaway'
            - condition: state
              entity_id: group.persons
              state: 'not_home'
            - condition: state
              entity_id: input_select.house_mode
              state: 'Night'
          sequence:
            - service: input_select.select_option
              data:
                entity_id: input_select.house_mode
                option: 'Awake'


- id: '1301'
  alias: Morning lights
  trigger:
    - platform: state
      id: "morninglight"
      endtity_id: input_select.house_mode
      to: "Awake"
 
  action:
    - choose:
        - conditions:
            - condition: trigger
              id: "morninglight"
            - condition: template
              value_template: "{{ state_attr('sun.sun','rising') == true }}"
            - condition: state
              entity_id: binary_sensor.lights
              state: "on"
          sequence:
            - service: scene.turn_on
              data: {}
              target:
                entity_id: scene.morning_lights
        - conditions:
            - condition: trigger
              id: "morningnolights"
            - condition: template
              value_template: "{{ state_attr('sun.sun','rising') == true }}"
          sequence:
            - service: scene.turn_on
              data: {}
              target:
                entity_id: scene.morning_nolights


- id: '1303'
  alias: Morning time Kitchen
  trigger:
    - platform: state
      entity_id: input_select.house_mode
      from: "Night"
      to: "Awake"
  condition:
    - condition: template
      value_template: "{{ state_attr('sun.sun','rising') == true }}"
  action:
    - wait_for_trigger:
        - platform: state
          entity_id: binary_sensor.hallway_pir
          from: "off"
          to: "on"
      timeout:
        minutes: "02:00:00"
      continue_on_timeout: false
    - service: media_player.play_media
      target:
        entity_id: media_player.kitchen
      data:
        media_content_type: "playlist"
        media_content_id: "x-rincon-mp3radio://https://radio.virginradio.co.uk/stream?DIST=TuneIn&TGT=TuneIn&maxServers=2&partnertok=eyJhbGciOiJIUzI1NiIsImtpZCI6InR1bmVpbiIsInR5cCI6IkpXVCJ9.eyJ0cnVzdGVkX3BhcnRuZXIiOnRydWUsImlhdCI6MTYzNDQ1NzE2NSwiaXNzIjoidGlzcnYifQ.itqk3ofOm8_NsySjWahGe4lWpUnmxPFegf3VdiUSlIA"
        volume_level: 0.22
    - service: scene.turn_on
      data: {}
      target:
        entity_id: scene.appliances_on